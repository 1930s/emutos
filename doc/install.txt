Installing:

You will need the (cross-)gcc toolchain from the sparemint pages to
build this stuff. You will also probably need GNU make.

building EmuTOS
===============

to build, simply do

    make

This will create a TOS2 image file 'emutos2.img', configured by
default for the US country. A list of the main Makefile targets is
obtained by doing 

    make help

To build EmuTOS for a different country (changes the language and the
keyboard), do

    make COUNTRY=en
or
    make COUNTRY=fr
or
    make COUNTRY=de

Finally, some settings can be configured in the file include/config.h.


Emulator-specific notes
=======================

STonX
-----

EmuTOS now needs no change in STonX any longer. It will run on a
normal STonX. 

But, if you want to see debugging output in STonX, you need to do two
things:

1. implement a write_native function in gemdos.c of STonX:

    /* Print string from emulated side */
    void write_native(char * addr)
    {
	char buf[1024];
	int n;

	for(n = 0 ; n < 1023 ; n++) {  /* Fill string char by char */
	    if ( (buf[n]=LM_UB(MEM(addr++))) == 0) break;
	}
	buf[1023] = 0;
        fprintf(stderr,"%s", buf);
    }

    void call_native(UL as, UL func)
    {
    #if 0
	fprintf(stderr,"Calling native %d\n",func);
    #endif
	switch (func)
	{
        case 0: /* Get the address, where string begins*/
            write_native((char *)LM_UL(MEM(as)));
            break;
        case 1:
    ...

(STonC release 0.8.0 and later already has this function)

2. Switch on the debugging output by setting, in include/config.h, the
   parameter STONX_NATIVE_PRINT to 1 before building EmuTOS.

ARAnyM
------

To switch on the debugging output, set in include/config.h the
parameter ARANYM_NATIVE_PRINT to 1 before building EmuTOS.

use the 'falcon' Makefile target


Other emulators
---------------

By default the emutos2.img ROM image is not padded to a particular size.
However some emulators expect ROM images with a fixed size of 192k, 
or 256k, or 512k. for these emulators, Use 'make 256' or 'make 512' to 
create etos256k.img and etos512k.img, ROM images padded to the specified size.

Note: Since the inclusion of the AES and VDI, EmuTOS no longer can fit
in a 192k image. If you want a 192k TOS1 ROM absolutely try 

    make WITH_AES=0 192

Hope this is all. AND: EmuTOS is not thought for the public right now.
It is alpha!!! Although it may run well for you, it is not bug tested.


Have success!
--
Your EmuTOS team
